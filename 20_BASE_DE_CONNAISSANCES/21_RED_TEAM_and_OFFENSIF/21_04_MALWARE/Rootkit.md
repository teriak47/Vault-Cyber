---
aliases:
  - Rootkit
  - Rootkits
  - Kit de racine
archetype: malware
famille: null
type: rootkit
cssclasses:
  - max
tags:
  - malware
  - rootkit
  - persistance
  - evasion
  - systeme-exploitation
  - noyau/kernel
  - firmware
  - privileges/elevation
  - vulnerabilite
  - ingenierie-sociale/phishing
  - vecteur-attaque/usb-infectee
  - malware/bootkit
  - malware/fileless
  - rootkit/masquage-fichiers
  - rootkit/masquage-processus
  - hyperviseur
  - attaque/evil-maid
---

# Rootkit

> [!bug] Fiche Technique
> *   **Type** : Rootkit (logiciel malveillant axÃ© sur la furtivitÃ© et l'accÃ¨s privilÃ©giÃ©)
> *   **Cible** : SystÃ¨mes d'exploitation (Windows, Linux, macOS), micrologiciels (firmware), hyperviseurs, secteurs de dÃ©marrage
> *   **PremiÃ¨re apparition** : DÃ©but des annÃ©es 1990 (environnements Unix) ; NTRootkit (Windows NT, 1999)

## ðŸ§¬ Analyse des MÃ©canismes d'OpÃ©ration

Les rootkits ne sont pas des malwares autonomes au sens strict ; ils constituent une collection d'outils logiciels, gÃ©nÃ©ralement malveillants, conÃ§us pour masquer leur prÃ©sence et celle d'autres logiciels, tout en maintenant un accÃ¨s privilÃ©giÃ© sur un systÃ¨me compromis. Leur cycle de vie comprend gÃ©nÃ©ralement les phases suivantes :

1.  **Infection** :
    *   Les rootkits sont souvent livrÃ©s en *bundle* avec d'autres types de malwares, tels que des chevaux de Troie ou des virus.
    *   Ils exploitent des **vulnÃ©rabilitÃ©s logicielles** pour obtenir des privilÃ¨ges Ã©levÃ©s, comme l'escalade de privilÃ¨ges.
    *   Les vecteurs d'infection courants incluent les **campagnes de phishing** (via des piÃ¨ces jointes malveillantes ou des liens), les *drive-by downloads* Ã  partir de sites web compromis et les kits d'exploitation.
    *   Des supports physiques, comme les **clÃ©s USB infectÃ©es**, peuvent Ã©galement Ãªtre utilisÃ©s.
    *   Dans certains cas, l'installation peut Ãªtre **manuelle** par un attaquant ayant dÃ©jÃ  obtenu un accÃ¨s (ex: attaque *evil maid*).

2.  **Installation** :
    *   Une fois exÃ©cutÃ©, le rootkit cherche Ã  obtenir des **privilÃ¨ges Ã©levÃ©s** (accÃ¨s *root* ou administrateur) afin de modifier des composants critiques du systÃ¨me.
    *   Il s'implante profondÃ©ment dans le systÃ¨me d'exploitation, que ce soit au niveau du **noyau (kernel)**, des pilotes de pÃ©riphÃ©riques, des secteurs de dÃ©marrage ou du micrologiciel (firmware).
    *   Les rootkits peuvent remplacer ou modifier des binaires lÃ©gitimes et **intercepter les appels systÃ¨me** (API hooking) pour subvertir les fonctions du systÃ¨me d'exploitation.
    *   L'injection de code dans des processus lÃ©gitimes ou des fichiers systÃ¨me critiques est une technique courante.

3.  **MÃ©canismes d'Ã‰vasion (FurtivitÃ©)** :
    *   **Masquage de fichiers et processus** : Les rootkits manipulent les systÃ¨mes de fichiers et interceptent les appels API (par exemple, `readdir()` sur Linux) pour filtrer les entrÃ©es malveilluses des utilitaires systÃ¨me (comme `ls`, `ps`, ou le Gestionnaire des tÃ¢ches sous Windows), rendant ainsi leurs composants invisibles aux outils de surveillance standard.
    *   **Modification du comportement systÃ¨me** : En altÃ©rant les composants fondamentaux de l'OS (noyau, pilotes), les rootkits font en sorte que leurs activitÃ©s malveillantes apparaissent comme lÃ©gitimes.
    *   **DÃ©sactivation/Tromperie des outils de sÃ©curitÃ©** : Ils peuvent dÃ©sactiver les logiciels antivirus, antimalwares et les pare-feux, ou bloquer leurs tentatives d'intercepter les fonctions malveillantes.
    *   **AltÃ©ration des journaux** : Les rootkits modifient ou dÃ©sactivent les mÃ©canismes de journalisation des Ã©vÃ©nements pour effacer toute trace de leur infiltration et de leurs activitÃ©s.
    *   **Techniques sans fichier (Fileless)** : Certains rootkits utilisent des techniques basÃ©es sur la mÃ©moire, ne laissant aucune trace sur le disque, ce qui rend la dÃ©tection basÃ©e sur les signatures presque impossible.
    *   **OpÃ©ration au niveau de l'hyperviseur** : En se plaÃ§ant sous le systÃ¨me d'exploitation, les rootkits de type hyperviseur sont extrÃªmement difficiles Ã  dÃ©tecter depuis le systÃ¨me d'exploitation invitÃ©.

4.  **MÃ©canismes de Persistance** :
    *   **Modification du dÃ©marrage systÃ¨me** : Ils installent des pilotes du noyau qui se rechargent au redÃ©marrage, modifient les fichiers de dÃ©marrage systÃ¨me et crÃ©ent ou altÃ¨rent des services systÃ¨me pour garantir leur lancement automatique.
    *   **Infection du secteur de dÃ©marrage (Bootkits)** : Les bootkits infectent le Master Boot Record (MBR), le Volume Boot Record (VBR) ou le micrologiciel UEFI (Unified Extensible Firmware Interface) pour s'exÃ©cuter avant mÃªme le chargement du systÃ¨me d'exploitation.
    *   **Infection du micrologiciel/BIOS** : Certains rootkits rÃ©sident dans le micrologiciel des pÃ©riphÃ©riques (routeurs, cartes rÃ©seau, BIOS/UEFI), ce qui leur permet de survivre aux rÃ©installations du systÃ¨me d'exploitation et, dans les cas extrÃªmes, de nÃ©cessiter un remplacement matÃ©riel pour Ãªtre Ã©radiquÃ©s.
    *   **Remplacement de fichiers lÃ©gitimes** : Ils peuvent remplacer des fichiers systÃ¨me lÃ©gitimes par des versions infectÃ©es qui chargent les composants malveillants au dÃ©marrage.
    *   **Processus *watchdog*** : Des processus "chiens de garde" peuvent Ãªtre crÃ©Ã©s pour relancer les composants du rootkit s'ils sont terminÃ©s.
    *   **Abonnements aux Ã©vÃ©nements WMI** : Les rootkits avancÃ©s peuvent utiliser des fonctionnalitÃ©s systÃ¨me lÃ©gitimes, comme les abonnements aux Ã©vÃ©nements Windows Management Instrumentation (WMI), pour redÃ©marrer automatiquement leurs composants en cas de suppression.

5.  **Action (Charge Utile)** :
    *   Fournir un **accÃ¨s de porte dÃ©robÃ©e** et un contrÃ´le Ã  distance sur le systÃ¨me compromis.
    *   **Masquer d'autres malwares** (ransomwares, enregistreurs de frappe, virus, bots, cryptominers) pour permettre des activitÃ©s malveillantes non dÃ©tectÃ©es.
    *   **Vol de donnÃ©es et surveillance** : Capturer les frappes au clavier, enregistrer des captures d'Ã©cran, surveiller le trafic rÃ©seau et voler des informations sensibles.
    *   **Manipuler les configurations du systÃ¨me**.
    *   Lancer d'autres attaques, comme des attaques par dÃ©ni de service distribuÃ© (DDoS) via des botnets.

## ðŸ”¬ Indicateurs de Compromission (IOCs)
Ã‰tant donnÃ© que les rootkits sont conÃ§us pour se cacher, leurs IOCs sont souvent indirects et comportementaux :

| Type | Valeur | Commentaire |
|---|---|---|
| **Comportement** | ArrÃªt inattendu de logiciels de sÃ©curitÃ© | Le rootkit peut dÃ©sactiver ou interfÃ©rer avec les dÃ©fenses. |
| **Comportement** | ActivitÃ© rÃ©seau inhabituelle/anormale | Envoi/rÃ©ception de donnÃ©es par des serveurs externes. |
| **Comportement** | Ralentissement ou plantages systÃ¨me frÃ©quents | Bien que cachÃ©s, des rootkits dÃ©fectueux peuvent affecter les performances. |
| **Analyse mÃ©moire** | Modifications des structures du noyau (DKOM) | DÃ©tection via des outils d'analyse mÃ©moire spÃ©cialisÃ©s. |
| **Analyse hors ligne** | Fichiers de dÃ©marrage ou micrologiciel altÃ©rÃ©s | NÃ©cessite des scanners anti-rootkit bootables ou des outils de flashage de firmware. |
| **Registres/Journaux** | EntrÃ©es de registre ou journaux systÃ¨me masquÃ©s/supprimÃ©s | Indique une tentative d'effacement des traces. |

## ðŸ§¹ DÃ©sinfection
> [!tip] ProcÃ©dure
> 1.  **Isoler la machine** du rÃ©seau pour prÃ©venir toute propagation ou exfiltration de donnÃ©es.
> 2.  Utiliser des **scanners anti-rootkit spÃ©cialisÃ©s** et Ã  jour. Ces outils sont souvent exÃ©cutÃ©s depuis un environnement de confiance (comme un Live CD/USB) pour Ã©viter que le rootkit n'interfÃ¨re avec la dÃ©tection.
> 3.  Effectuer une **analyse des dumps mÃ©moire** pour identifier les instructions et processus cachÃ©s du rootkit.
> 4.  En cas de dÃ©tection persistante ou de doute, la **rÃ©installation complÃ¨te du systÃ¨me d'exploitation** est souvent la seule mÃ©thode garantie pour Ã©radiquer le rootkit.
> 5.  Pour les rootkits de micrologiciel, un **re-flashage du BIOS/UEFI** peut Ãªtre nÃ©cessaire. Dans les cas les plus extrÃªmes, un remplacement matÃ©riel peut Ãªtre la seule solution viable.

## ðŸ”— Notes Connexes
*   **Exemples notables** : Stuxnet, Flame, Necurs, Sony BMG rootkit, CosmicStrand UEFI Rootkit, NTRootkit, HackerDefender.