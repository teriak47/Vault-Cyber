---
archetype: cour
module: "GEN (Culture G√©n√©rale & Hors Cursus)"
aliases:
  - "01-21 | Rapport de Pentest Professionnel"
cssclasses:
  - max
tags:
  - pentest
  - pentest/reporting
  - rapport-audit
  - methodologie
  - pentest/methodologie
  - framework/ptes
  - framework/osstmm
  - owasp-top-10
  - mitre-att-ck
  - vulnerabilite/gestion
  - gestion-des-risques
  - cvss
  - executive-summary
  - pentest/remediation
  - pentest/scoping
---

# 01-21 | Rapport de Pentest Professionnel

> [!goal] Objectifs P√©dagogiques
> √Ä la fin de cette fiche, chaque participant doit √™tre capable de :
> 1. R√©diger un **Executive Summary clair** et non technique.
> 2. D√©crire la **port√©e**, le p√©rim√®tre et les limites d'un test d'intrusion.
> 3. Structurer la partie **m√©thodologie** en utilisant des standards reconnus (OSSTMM, PTES, OWASP, MITRE ATT&CK).
> 4. Documenter les vuln√©rabilit√©s avec une **fiche standard et compl√®te**.
> 5. √âvaluer le risque (CVSS / Impact m√©tier) et prioriser les corrections.
> 6. Fournir des recommandations exploitables par les √©quipes IT et la direction.
> 7. Structurer les annexes techniques (preuves, commandes, logs).
> 8. Cr√©er une version "client" et une version "technique" du rapport.

## üìù Synth√®se du Cours

Le **Rapport de Pentest Professionnel** est le livrable final crucial de toute mission de test d'intrusion. Il synth√©tise les d√©couvertes, √©value les risques et propose des actions correctives. Ce module vise √† √©tablir une **m√©thodologie standard** et un mod√®le complet pour garantir une qualit√© homog√®ne des rapports, compr√©hensibles tant par le management que par les √©quipes techniques.

### 1. Pr√©-requis Essentiels

Avant la r√©daction du rapport, il est imp√©ratif d'avoir men√© √† bien les phases techniques du pentest et de disposer de toutes les informations collect√©es, notamment les fiches d'exposition des modules pr√©c√©dents :
*   R√©seau
*   Syst√®me
*   Web
*   SQLi
*   Password
*   Wi-Fi
*   Exploitation
*   AD Attacks
*   Post-exploitation
*   Pivoting
*   Red Team

L'objectif est de transformer toutes ces donn√©es brutes en un **rapport unique, coh√©rent et professionnel**.

### 2. Structure Standard d'un Rapport de Pentest

Un rapport de pentest professionnel suit g√©n√©ralement une structure harmonis√©e, inspir√©e des standards internationaux comme PTES, OSSTMM et ISSAF.

#### A. Page de Couverture
La page de couverture doit inclure les informations cl√©s pour identifier le rapport :
*   Nom de l'entreprise audit√©e
*   Nom du consultant / de l'√©quipe d'audit
*   Type de test (Pentest Interne / Externe / Web / AD / Red Team)
*   Dates de r√©alisation du test
*   Num√©ro de version du rapport
*   Mention de confidentialit√© (ex: STRICTEMENT CONFIDENTIEL ‚Äî DIFFUSION LIMIT√âE)

#### B. Executive Summary (Synth√®se Ex√©cutive)
Destin√© √† la direction et au management, ce r√©sum√© doit √™tre **non technique** et ne pas d√©passer **10 lignes**. Il doit r√©pondre aux questions suivantes :
*   Quel a √©t√© l'objet du test ?
*   Quel est le niveau de risque global identifi√© ?
*   Quelles sont les vuln√©rabilit√©s critiques majeures ?
*   Une compromission compl√®te a-t-elle √©t√© d√©montr√©e ou est-elle possible ?
*   Quelles sont les recommandations globales prioritaires ?

> [!note] Exemple d'Executive Summary
> "Le test d'intrusion interne a r√©v√©l√© plusieurs vuln√©rabilit√©s critiques permettant √† un attaquant interne d'obtenir un acc√®s complet aux donn√©es sensibles en moins de 2 heures. Les m√©canismes de segmentation, d'authentification et de patching pr√©sentent des faiblesses majeures. Une compromission totale du domaine Active Directory a √©t√© d√©montr√©e. Des recommandations prioritaires ont √©t√© formul√©es pour r√©duire le risque global de compromission."

#### C. Port√©e et Limites du Test
Cette section d√©finit pr√©cis√©ment le cadre de l'audit.
*   **Port√©e :**
    *   Syst√®mes, r√©seaux, applications inclus dans le p√©rim√®tre.
    *   Comptes fournis ou non (type d'acc√®s initial).
    *   Type de test (interne / externe, Grey box / Black box / White box).
*   **Limites :**
    *   Exclusion explicite de certains types d'attaques (ex: DoS, exploitation destructrice, alt√©ration de donn√©es).
    *   Pr√©cisions sur les conditions de test (ex: r√©alis√©es en conditions normales, sans impact sur la production).

#### D. M√©thodologie
Pr√©senter les standards et l'approche utilis√©s pour le pentest :
*   **Standards :** PTES (Penetration Testing Execution Standard), OWASP Web / API Security Testing Guide, OSSTMM (Open Source Security Testing Methodology Manual), MITRE ATT&CK (pour les missions Red Team).
*   **Phases du test :**
    1.  Reconnaissance passive & active
    2.  Scan r√©seau
    3.  √ânum√©ration des services
    4.  Tests Web (selon l'OWASP Top 10)
    5.  Tests d'authentification et d'autorisation
    6.  Exploitation des vuln√©rabilit√©s
    7.  Mouvement lat√©ral et persistance
    8.  Escalade de privil√®ges
    9.  Exfiltration simul√©e de donn√©es (si autoris√©e)

#### E. R√©sultats Globaux (Heatmap)
Une **matrice visuelle du risque** est essentielle pour une compr√©hension rapide. Elle combine l'impact de la vuln√©rabilit√© et sa criticit√©.

| Criticit√© / Impact | Critique | √âlev√© | Moyen | Faible |
| :----------------- | :------- | :---- | :---- | :----- |
| **Critique**       | 4        | 3     | 2     | 1      |
| **√âlev√©**          | 3        | 2     | 1     |        |
| **Moyen**          | 2        | 1     |       |        |
| **Faible**         | 1        |       |       |        |

Exemple de tableau r√©capitulatif des vuln√©rabilit√©s principales :

| Vuln√©rabilit√©      | Criticit√© Impact       | Facilit√© d'exploitation |
| :----------------- | :--------------------- | :---------------------- |
| Kerberoasting      | Critique AD compromise | √âlev√©e                  |
| SQL Injection      | Critique Dump DB       | Moyenne                 |
| SMB Signing Off    | √âlev√© Cred Harvesting  | √âlev√©e                  |
| Password faibles   | √âlev√© Mvt lat√©ral      | Tr√®s √©lev√©e             |
| Services obsol√®tes | Moyen Post-exploitation| Moyenne                 |
| Headers Web        | Faible Info leak       | Faible                  |

#### F. Vuln√©rabilit√©s D√©taill√©es
Chaque vuln√©rabilit√© d√©couverte doit √™tre document√©e de mani√®re exhaustive dans une **fiche compl√®te** :
1.  **Titre**
2.  **Criticit√©** (Critique / √âlev√©e / Moyenne / Faible)
3.  **Description** d√©taill√©e de la vuln√©rabilit√©
4.  **Impact** (technique et m√©tier)
5.  **Vecteur d'exploitation** (comment elle a √©t√© exploit√©e)
6.  **Preuve technique** (captures d'√©cran, commandes ex√©cut√©es, extraits de code)
7.  **Recommandation** sp√©cifique et concr√®te pour la correction
8.  **R√©f√©rence** (CVE, CWE, OWASP Top 10)
9.  **Annexe** (logs, scripts, etc., si pertinent)

> [!note] Exemple de fiche de vuln√©rabilit√© : Kerberoasting
> *   **Criticit√© :** Critique
> *   **Description :** Le domaine Active Directory autorise la r√©cup√©ration des tickets TGS (Service Ticket Granting Service) de comptes de service ayant des noms de principal de service (SPN) non prot√©g√©s, exposant leurs hachages de mots de passe.
> *   **Preuve :**
>     `GetUserSPNs.py domain.local/user:pass -request`
>     `hashcat -m 13100 hash rockyou.txt`
> *   **Impact :** Compromission de comptes de service potentiellement privil√©gi√©s, pouvant mener √† une escalade de privil√®ges et √† une compromission compl√®te du domaine Active Directory en moins de 30 minutes.
> *   **Recommandation :** Imposer des mots de passe robustes (> 25 caract√®res) pour les comptes de service et prot√©ger ces comptes avec l'attribut `msDS-SupportedEncryptionTypes` ou migrer vers des comptes de service g√©r√©s (gMSA).
> *   **R√©f√©rence :** CWE-522, MITRE ATT&CK T1558.003

#### G. Recommandations Globales
Cette section regroupe l'ensemble des mesures correctives, class√©es par type et par priorit√©.

##### 1. Corrections techniques
*   Mise en place de l'authentification multi-facteurs (MFA).
*   Politique stricte de rotation des mots de passe.
*   Application r√©guli√®re et compl√®te des patchs OS et applicatifs.
*   Activation obligatoire du SMB Signing.
*   D√©sactivation des protocoles obsol√®tes (ex: NTLM v1).
*   Impl√©mentation de la segmentation r√©seau.
*   Durcissement de l'Active Directory (LAPS, mod√®le de tiering, gMSA).

##### 2. Corrections organisationnelles
*   D√©veloppement d'une politique de gestion des vuln√©rabilit√©s.
*   Tests r√©guliers et valid√©s des proc√©dures de sauvegarde et de restauration.
*   Maintien d'un inventaire pr√©cis et √† jour des actifs.
*   Programmes de formation et de sensibilisation des utilisateurs √† la cybers√©curit√©.

##### 3. Priorisation des Actions (P1 -> P4)
*   **P1 :** √Ä corriger imm√©diatement (vuln√©rabilit√©s critiques avec impact √©lev√©).
*   **P2 :** < 30 jours (vuln√©rabilit√©s √©lev√©es avec impact significatif).
*   **P3 :** < 90 jours (vuln√©rabilit√©s moyennes).
*   **P4 :** Planification √† long terme (vuln√©rabilit√©s faibles ou am√©liorations de la posture de s√©curit√©).

#### H. Conclusion
La conclusion doit synth√©tiser les principaux constats et fournir une vision d'ensemble de la posture de s√©curit√© :
*   Le r√©seau est-il compromis et √† quel degr√© ?
*   L'organisation est-elle globalement √† risque ?
*   Quelles sont les actions prioritaires √† entreprendre pour am√©liorer la s√©curit√© ?

#### I. Annexes Techniques
Cette section contient toutes les preuves brutes et les d√©tails techniques qui soutiennent les d√©couvertes du rapport principal.
*   Rapports Nmap complets.
*   Captures d'outils (WhatWeb, ffuf, Gobuster).
*   Fiches d√©taill√©es des modules techniques (Syst√®me, Web, AD, etc.).
*   Hashes de mots de passe (sans les mots de passe en clair).
*   Scripts et exploits utilis√©s.
*   Logs des activit√©s Red Team.
*   Chemins de pivoting document√©s.
*   Arborescence Active Directory (si BloodHound a √©t√© utilis√©).

### 3. Commandes Essentielles pour la Documentation

Quelques commandes utiles pour exporter les r√©sultats :
*   **Export Nmap complet :** `nmap -A -oA report_full 192.168.0.0/24`
*   **Export SQLMap :** `sqlmap -r login.req --batch --dump --output-dir=report/`
*   **Export BloodHound (exemple pour CME) :** `cme smb 192.168.0.0/24 -u user -p pass > cme_results.txt`

### 4. Crit√®res de Validation d'un Rapport de Pentest

Un rapport est consid√©r√© comme valid√© si le participant :
1.  Produit un rapport complet, bien structur√© et professionnel.
2.  R√©dige un Executive Summary clair et concis.
3.  Documente un minimum de **8 vuln√©rabilit√©s** d√©taill√©es.
4.  Fournit des preuves techniques claires et pertinentes.
5.  √âtablit un plan d'action prioris√© et exploitable.
6.  Livre √† la fois une version "client" et une version "technique" du rapport.

## üß† Carte Mentale / Sch√©ma
```mermaid
graph TD
    A["Rapport de Pentest Professionnel"] --> B["Page de Couverture"]
    A --> C["Executive Summary"]
    A --> D["Port√©e et Limites"]
    A --> E["M√©thodologie"]
    A --> F["R√©sultats Globaux (Heatmap)"]
    A --> G["Vuln√©rabilit√©s D√©taill√©es"]
    A --> H["Recommandations Globales"]
    A --> I["Conclusion"]
    A --> J["Annexes Techniques"]

    E --> E1["PTES, OWASP, OSSTMM, MITRE ATT&CK"]
    E --> E2["Phases du Test"]

    G --> G1["Titre, Criticit√©, Description"]
    G --> G2["Impact, Vecteur d'Exploitation"]
    G --> G3["Preuve Technique, Recommandation"]
    G --> G4["R√©f√©rence, Annexe"]

    H --> H1["Corrections Techniques"]
    H --> H2["Corrections Organisationnelles"]
    H --> H3["Priorisation (P1-P4)"]
```

## ‚ùì Quiz de R√©vision (Active Recall)
> [!question] Question 1
> Quelle est l'audience principale de l'Executive Summary et pourquoi est-il important qu'il soit non technique ?
> > [!success]- R√©ponse
> > L'audience principale de l'Executive Summary est la direction et le management. Il est important qu'il soit non technique afin d'√™tre directement compr√©hensible par des d√©cideurs qui n'ont pas forc√©ment une expertise technique approfondie en cybers√©curit√©, leur permettant ainsi de saisir rapidement les risques et les actions prioritaires.

> [!question] Question 2
> Citez au moins trois standards de m√©thodologie de pentest qui peuvent √™tre mentionn√©s dans un rapport professionnel.
> > [!success]- R√©ponse
> > Trois standards de m√©thodologie de pentest incluent le PTES (Penetration Testing Execution Standard), l'OWASP (pour les tests Web/API), l'OSSTMM (Open Source Security Testing Methodology Manual) et MITRE ATT&CK (souvent pour la Red Team).

> [!question] Question 3
> Quelles informations essentielles doivent figurer dans une fiche de vuln√©rabilit√© d√©taill√©e ?
> > [!success]- R√©ponse
> > Une fiche de vuln√©rabilit√© d√©taill√©e doit inclure le titre, la criticit√©, une description, l'impact (technique et m√©tier), le vecteur d'exploitation, la preuve technique, une recommandation, et les r√©f√©rences (CVE/CWE/OWASP).